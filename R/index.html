



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.3">
    
    
      
        <title>R - AC Flower Factory</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.30686662.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#r" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="AC Flower Factory" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              AC Flower Factory
            </span>
            <span class="md-header-nav__topic">
              
                R
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="AC Flower Factory" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    AC Flower Factory
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../windflowers/" title="Windflowers" class="md-nav__link">
      Windflowers
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tidyverse" class="md-nav__link">
    Tidyverse
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ggplot2" class="md-nav__link">
    ggplot2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#programming-with-dplyr" class="md-nav__link">
    Programming with dplyr
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lubridate" class="md-nav__link">
    Lubridate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tibble" class="md-nav__link">
    Tibble
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packages" class="md-nav__link">
    Packages
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-them" class="md-nav__link">
    Creating them
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spatial" class="md-nav__link">
    Spatial
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useful-functions-to-remember" class="md-nav__link">
    Useful Functions to remember
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cookbook" class="md-nav__link">
    Cookbook
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#working-with-formula-object-in-r" class="md-nav__link">
    Working with formula object in R
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#row-wise-workflows" class="md-nav__link">
    Row-wise workflows
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-factors" class="md-nav__link">
    Working with factors
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-cleaning" class="md-nav__link">
    Data Cleaning
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shortcuts" class="md-nav__link">
    Shortcuts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kable" class="md-nav__link">
    Kable
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-r" class="md-nav__link">
    Advanced R
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-structures" class="md-nav__link">
    Data Structures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objects" class="md-nav__link">
    Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generic-functions" class="md-nav__link">
    Generic Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environments" class="md-nav__link">
    Environments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-things" class="md-nav__link">
    Environment things
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-checking" class="md-nav__link">
    Error checking
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix-related" class="md-nav__link">
    Matrix Related
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matrix-package" class="md-nav__link">
    Matrix Package
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matrix-decompositions" class="md-nav__link">
    Matrix Decompositions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis" class="md-nav__link">
    Analysis
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anovalm" class="md-nav__link">
    ANOVA/LM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nonlinear" class="md-nav__link">
    Nonlinear
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixed-models" class="md-nav__link">
    Mixed Models
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#glms" class="md-nav__link">
    GLMs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2x2-contingencies" class="md-nav__link">
    2x2 contingencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contrast-coding" class="md-nav__link">
    Contrast Coding
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useful-links" class="md-nav__link">
    Useful Links
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="r">R</h1>
<h2 id="tidyverse">Tidyverse</h2>
<h3 id="ggplot2">ggplot2</h3>
<p>See the <a href="https://ggplot2-book.org/">ggplot2 book</a> online for more information</p>
<h4>List of extensions to GGplot</h4>
<ul>
<li><a href="http://www.ggplot2-exts.org/gallery/">Website maintaining extensions</a> - makes it easier to find ggplot extensions for what you need</li>
<li><a href="https://evamaerey.github.io/little_flipbooks_library/taming_themes_in_ggplot/taming_ggplot_themes.html#1">Flipbook to modify major parts of the graph</a> - flipbook for messing with parts of the graph. </li>
<li><a href="https://cedricscherer.netlify.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/#prep">Blog version of modifying everything in ggplot2</a></li>
<li><a href="https://ggplot2tutor.com/powerlifting/squats/">Another step by step ggplot violin plot</a></li>
</ul>
<!-- #### ggraph

* layouts `ggraph(g, layout = "linear")`
  * linear
  * igraph
  * dendrogram
  * manual (specify with x, y dataframe)
  * treemap
  * circlepack
  * partition
  * hive
  * See `?ggraph` for more information
* colors
  * everything seems to be replaced with  -->

<h4>Legend</h4>
<pre><code class="R">theme(legend.position = c(.8, .2)) # top, bottom, left, right
geom_point(aes(x,y), show.legend = FALSE) 
</code></pre>

<h4>Scales/Palettes</h4>
<p>Using RColorBrewer</p>
<pre><code class="r">RColorBrewer::display.brewer.all() # see all palettes 

scale_color_brewer(palette = &quot;RdPu&quot;) # distinct colors
scale_color_distiller(palette = &quot;RdPu&quot;) # for continuous data
</code></pre>

<p>Using manual scales</p>
<p><img alt="" src="http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/figure/unnamed-chunk-5-1.png" />
<img alt="" src="http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/figure/unnamed-chunk-5-2.png" /></p>
<pre><code class="R">scale_linetype_manual(name = &quot;Linetypes&quot;, labels=c(...), values = c(&quot;blank&quot;, &quot;solid&quot;, &quot;dashed&quot;, &quot;dotted&quot;, &quot;dotdash&quot;, &quot;longdash&quot;, &quot;twodash&quot;))
# w/ grey
cbPalette &lt;- c(&quot;#999999&quot;, &quot;#E69F00&quot;, &quot;#56B4E9&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;, &quot;#0072B2&quot;, &quot;#D55E00&quot;, &quot;#CC79A7&quot;)
# w/ black
cbbPalette &lt;- c(&quot;#000000&quot;, &quot;#E69F00&quot;, &quot;#56B4E9&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;, &quot;#0072B2&quot;, &quot;#D55E00&quot;, &quot;#CC79A7&quot;)
scale_color_manual(name = &quot;Colors&quot;, values=cbPalette)
scale_fill_manual(name = &quot;Colors&quot;, values=cbPalette)
</code></pre>

<h4>Labels</h4>
<pre><code class="R">labs(x=&quot;x&quot;,
     y=&quot;y&quot;,
     title=&quot;Title&quot;,
     subtitle=&quot;Subtitle&quot;)
</code></pre>

<h4>Statistical Summaries</h4>
<pre><code class="r">ggplot(diamonds, aes(color, price)) + 
  geom_bar(stat = &quot;summary_bin&quot;, fun.y = mean)
</code></pre>

<h4>Themes</h4>
<p><a href="https://ggplot2-book.org/polishing.html">Ch 15 of ggplot2 book</a> has comprehensive guide on themes.</p>
<h4>Multiplots</h4>
<pre><code class="R">library(gridExtra)
plot1 &lt;- qplot(1)
plot2 &lt;- qplot(1)
grid.arrange(plot1, plot2, ncol=2)
</code></pre>

<h4>Ggplotly</h4>
<ul>
<li><a href="https://stackoverflow.com/questions/36325154/how-to-choose-variable-to-display-in-tooltip-when-using-ggplotly">Example of customizing tooltip</a></li>
</ul>
<h4>Cool example of detailed visualizations in ggplot</h4>
<ul>
<li><a href="https://github.com/MNoichl/Cocktails/blob/master/Cocktails-Cleanup.ipynb">Cocktails with UMAP</a></li>
</ul>
<h4>Saving plots</h4>
<ul>
<li><a href="https://rdrr.io/github/bjeil/beTools/src/R/qSave.r">Nice defaults for plots in slides</a></li>
</ul>
<h3 id="programming-with-dplyr">Programming with dplyr</h3>
<ul>
<li><code>quo</code> - is used to mark the variable name as literal, kind of like quotes "</li>
<li><code>enquo</code> - is used to look INSIDE what the variable, and quote that! It uses "dark magic"</li>
</ul>
<pre><code class="r">my_summarise &lt;- function(df, group_var) {
  df %&gt;%
    group_by(!! group_var) %&gt;%
    summarise(a = mean(a))
}

my_summarise(df, quo(g1))
</code></pre>

<p>In order to make the call <code>my_summarise(df, g1)</code>, we need to make the following change:</p>
<pre><code class="r">my_summarise &lt;- function(df, group_var) {
  group_var &lt;- enquo(group_var)
  df %&gt;%
    group_by(!! group_var) %&gt;%
    summarise(a = mean(a))
}

my_summarise(df, g1)
</code></pre>

<ul>
<li>If you have a string that you want denoted, you should use <code>rlang::sym</code> as suggested <a href="https://stackoverflow.com/questions/44121728/programming-with-dplyr-using-string-as-input">here</a>.</li>
<li>When you want a variable for the column name, you need to make use of the syntax <code>!! colname := function(x) ...</code>, otherwise it's not valid R code.</li>
<li>You can filter with expressions using the <code>parse_expr</code> function in the <code>rlang</code> package as follows</li>
</ul>
<pre><code class="r">expr &lt;- paste0(&quot;s&quot;,1:2, &quot; == &quot;, c(0,1), collapse = &quot; &amp; &quot;) # s1 == 0 &amp; s2 == 1
filter(df, !!parse_expr(expr)) 
</code></pre>

<h4>Recipes</h4>
<ol>
<li><a href="https://stackoverflow.com/questions/24576515/relative-frequencies-proportions-with-dplyrS">Getting relative frequencies from dplyr</a> - note that summarize unwraps the last grouping, can check with <code>groups()</code>. useful for bar plots of the frequencies</li>
</ol>
<pre><code class="R">mtcars %&gt;%
  group_by(am, gear) %&gt;%
  summarise(n = n()) %&gt;%
  mutate(freq = n / sum(n)) # Gets Rel Freq from WITHIN all counts of am
</code></pre>

<ol>
<li><a href="https://stackoverflow.com/questions/5208679/order-bars-in-ggplot2-bar-graph">Reordering x for bar graphs</a></li>
</ol>
<pre><code class="R">ggplot(theTable,
       aes(x=reorder(Position,Position,
                     function(x)-length(x)))) +
       geom_bar()
</code></pre>

<h3 id="lubridate">Lubridate</h3>
<h3 id="tibble">Tibble</h3>
<ul>
<li><code>as_tibble(...,)</code></li>
<li>For forcing matrices, <code>as_tibble(mat, .name_repair = ~c("a", "b", "c"))</code> allows you to name the columns for matrices without column names in one line</li>
<li><code>bind_rows</code> or <code>bind_col</code> is more efficient for combining lots of dataframes</li>
</ul>
<h2 id="packages">Packages</h2>
<h3 id="creating-them">Creating them</h3>
<p><a href="https://cran.r-project.org/doc/manuals/R-exts.pdf">R official reference</a> - pretty complete version of creating the packages</p>
<h3 id="spatial">Spatial</h3>
<p><a href="https://www.zevross.com/blog/2019/05/01/unscientific-list-of-popular-r-packages-for-spatial-analysis/">Source list for spatial with crowd sourced twitter</a></p>
<details>
<summary> List of packages </summary>

<ul>
  <li>sf</li>
  <li>raster</li>
  <li>sp</li>
  <li>leaflet</li>
  <li>tmap</li>
  <li>mapview</li>
  <li>rgdal</li>
  <li>cartography</li>
  <li>gstat</li>
  <li>tigris</li>
</ul>

</details>

<h2 id="useful-functions-to-remember">Useful Functions to remember</h2>
<ul>
<li><code>gl()</code> - Factor level generation</li>
<li><code>xtabs()</code> - Cross table generation</li>
<li><code>table()</code> - see table of distribution</li>
<li><code>search()</code> see all packages that have been loaded</li>
</ul>
<h2 id="cookbook">Cookbook</h2>
<h3 id="working-with-formula-object-in-r">Working with formula object in R</h3>
<pre><code class="r">formula(y~x1 + x2) # create the formula object
frame &lt;- model.frame(formula, data, drop.unused.levels = TRUE) # Get the relevant columns in the data frame used in the formula
model.matrix(formula, frame) # create the `X` matrix for working with the levels in the frame above based on formula
</code></pre>

<p><code>attr(rhs, "assign")</code> - attribute contains the index of variable that each column of model matrix comes from. If 3 levels, you would need intercept, and 2 columns of the model matrix.</p>
<h3 id="row-wise-workflows">Row-wise workflows</h3>
<p>Examples in <a href="https://github.com/jennybc/row-oriented-workflows#readme">this workshop</a></p>
<h3 id="working-with-factors">Working with factors</h3>
<pre><code class="r">as.numeric(levels(temp))[temp] # unfactor temp
factor(cheese$additive, levels(cheese$additive)[c(4,1:3)]) # Reorder the factors
reorder(cheese$additive, cheese$scores, FUN = mean) # Relevel additives factor, by their average score
</code></pre>

<h2 id="data-cleaning">Data Cleaning</h2>
<p>Use <code>library(tidyr)</code>, this is the new interface into reshape</p>
<ul>
<li><code>gather()</code> - fat to narrow</li>
<li><code>spread()</code> - narrow to fat</li>
</ul>
<pre><code class="R">gather(key, value, columns)
</code></pre>

<p><a href="https://aosmith.rbind.io/2018/07/19/legends-constants-for-aesthetics-in-ggplot2/">GGplot force legend with constant aes</a></p>
<h2 id="shortcuts">Shortcuts</h2>
<p><code>Option+ Shift + k</code> - show keyboard shortcuts</p>
<h2 id="kable">Kable</h2>
<pre><code class="R">kable(TABLE, booktabs=T) %&gt;% kable_styling(position = center) %&gt;% row_spec(2, hline_after=T)
</code></pre>

<h2 id="advanced-r">Advanced R</h2>
<h3 id="data-structures">Data Structures</h3>
<ul>
<li>6 Atomic types: logical, integer, double, character, complex, raw</li>
<li>3 properties of vectors: typeof(), length(), attributes()</li>
<li>Coercion is least to most flexible, atomic type</li>
<li>Most important attributes: Names, Dimensions, Class</li>
</ul>
<h3 id="objects">Objects</h3>
<p>Need <code>library(pryr)</code> to use the main functions.</p>
<ul>
<li><code>typeof()</code> - base type</li>
<li><code>otype()</code> - object type</li>
<li><code>ftype()</code> - tells you if "generic" function or "method"</li>
<li><code>is.object(x)</code> - Checks if has "class" attribute</li>
</ul>
<h3 id="generic-functions">Generic Functions</h3>
<p>In the S3 Object system, methods don't belong to a class, but belong to a generic function.</p>
<p>Generic are responsible for something called <em>method dispatch</em> in which they are supposed to find the right method to use for the call. This is a system for polymorphism that is used in the Lisp system, but not very common otherwise.</p>
<pre><code class="R">ftype()
summary # the generic function
summary.lm # methods associated with generic function
summary.glm 

&gt; ftype(summary)
[1] &quot;s3&quot;      &quot;generic&quot;
&gt; ftype(summary.lm)
[1] &quot;s3&quot;     &quot;method&quot;
&gt; methods(summary)
 [1] summary.aov                    summary.aovlist*              
 [3] summary.aspell*                summary.check_packages_in_dir*
 [5] summary.connection             summary.corAR1*               
 [7] summary.corARMA*               summary.corCAR1*   
</code></pre>

<p>Classes are very casual in S3, it's essentially treated as an attribute, and can even have multiple classes, eg. glm. <code>UseMethod</code> though will look for the appropriate method based on the class that you pass to the class. DO NOT USE <code>.</code> when naming methods! It will make it look like an S3 object</p>
<pre><code class="R">foo &lt;- c(1, 2, 3, 4)
class(foo) &lt;- &quot;something&quot;
t(foo) # will look for the method t.something to run
</code></pre>

<h3 id="environments">Environments</h3>
<p>Environments are basically just like lists, with 4 special characteristics.
1. They have parents,
2. elements of the list are not numbered
3. Each element defined is unique
4. Must use <code>rm()</code> to remove from environment, rather than setting to null.</p>
<ul>
<li>Special Environments</li>
<li><code>.GlobalEnv</code> (<code>globalenv()</code>) - the global environment</li>
<li><code>baseenv()</code> environment of base, parent is emptyenv</li>
<li><code>emptyenv()</code> # ancestor of all. Only environment without a parent.</li>
<li>Packages have two associated environments,</li>
</ul>
<p><code>ls()</code> - examine the elements of an environment
<code>rm()</code> - to remove something from environment
<code>ls.str()</code> - looks at the environment with structure as well</p>
<p><code>pryr::where("name")</code> - What environment is the name found in, with regular scoping rules</p>
<p><code>do.call(what, args, envir)</code> - construct</p>
<h3 id="environment-things">Environment things</h3>
<pre><code class="r">version
sessionInfo()
.libPaths()
</code></pre>

<h3 id="error-checking">Error checking</h3>
<p>When debugging a detailed series of function calls, can use: </p>
<pre><code class="r">options(error = recover)
</code></pre>

<h2 id="matrix-related">Matrix Related</h2>
<h3 id="matrix-package">Matrix Package</h3>
<p>These are the dense matrices
* <strong><code>dgeMatrix</code></strong> - Real matrices in general storage mode
* <code>dsyMatrix</code> - Symmetric real matrices in non-packed storage
* <strong><code>dspMatrix</code></strong> - Symmetric real matrices in packed storage (one triangle only)
* <code>dtrMatrix</code> - Triangular real matrices in non-packed storage
* <code>dtpMatrix</code> - Triangular real matrices in packed storage (triangle only)
* <code>dpoMatrix</code> - Positive semi-definite symmetric real matrices in non-packed storage
* <code>dppMatrix</code> - ditto  in packed storage</p>
<p>sparse matrices
* <code>dgTMatrix</code> - general, numeric, sparse matrices in (a possibly redundant) triplet form. This can be a convenient form in which to construct sparse matrices.
* <strong><code>dgCMatrix</code></strong> - general, numeric, sparse matrices in the (sorted) compressed sparse column format.
* <strong><code>dsCMatrix</code></strong> - symmetric, real, sparse matrices in the (sorted) compressed sparse column format. Only the upper or the lower triangle is stored. Although there is provision for both forms, the lower triangle form works best with TAUCS.
* <code>dtCMatrix</code> - triangular, real, sparse matrices in the (sorted) compressed sparse column format.</p>
<pre><code class="R">as(X, &quot;dgCMatrix&quot;)               # Force into sparse Matrix
forceSymmetric(x, uplo = &quot;U&quot;)    # take uplo = Upper (U) or Lower (L)
symmpart(x)                      # Average both upper and lower triangle
skewpart(x)                      # The difference between x and symmpart
</code></pre>

<h3 id="matrix-decompositions">Matrix Decompositions</h3>
<pre><code class="r">qrX &lt;- qr(X) # Gives QR object
qr.Q (qrX)   # Gives the Q part
qr.R(qrX)    # Gives the R part
qrX$rank     # Gives the rank
</code></pre>

<h2 id="analysis">Analysis</h2>
<h3 id="anovalm">ANOVA/LM</h3>
<ul>
<li><a href="https://threadreaderapp.com/thread/1223790298024726528.html">Helpful Twitter thread on ANOVA</a></li>
<li><a href="https://aosmith.rbind.io/2019/03/25/getting-started-with-emmeans/">Getting started with emmeans</a></li>
</ul>
<h3 id="nonlinear">Nonlinear</h3>
<ul>
<li><code>nls</code> - seems to be the function to do so in R</li>
</ul>
<pre><code class="r">mod &lt;- nls(..., start = list(a = 0, b =2)) # initialize parameters yourself to avoid fit issues
profile(mod, which = &quot;parameter&quot;)
confint(profile(mod)) # seems to be the safer way of doing things.. as to not run into optimization issues
</code></pre>

<h3 id="mixed-models">Mixed Models</h3>
<ul>
<li><code>ranef(mod)</code> - get random effects from model<ul>
<li><code>dotplot.ranef.mer(randef(mod))</code> - dotplot of random effects, needs lattice</li>
<li><code>attr(ranef(mod)$Subject, "postVar")</code> - There's also a "hidden" conditional variance associated with each of the random effects, these are accessed by the attribute "postVar" this is the vcov of each of the random effects I think?<ul>
<li><code>as.data.frame(ranef(mod))</code> gives a secret representation of conditional variances</li>
</ul>
</li>
</ul>
</li>
<li><code>getMF(mod, ["X", "Z"])</code> - get the fixed and random effect model matrices</li>
</ul>
<p>Further Reading
* <a href="https://stackoverflow.com/questions/26198958/extracting-coefficients-and-their-standard-error-from-lme">Getting subject level standard errors</a>
* <a href="https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html">Ben Bolker FAQ</a>
* <a href="https://stat.ethz.ch/pipermail/r-sig-mixed-models/2014q3/022509.html">Estimated zero variance of estimate, Bates Email thread</a></p>
<h3 id="glms">GLMs</h3>
<ul>
<li><code>model.matrix(mod)</code> - gets the design matrix</li>
<li><code>mod$linear.predictors</code> - X\beta</li>
</ul>
<h3 id="2x2-contingencies">2x2 contingencies</h3>
<ul>
<li><code>table(dat$tx, dat$survival)</code> - create contingency table</li>
<li><code>addmargins()</code> - add row and column sums to 2x2 table</li>
<li><code>cut(dat$w6minBl, quantile(dat$w6minBl,0:5/5,na.rm=T), include.lowest = TRUE))</code> - Create strata</li>
</ul>
<pre><code class="R">X &lt;- table(dat$tx,dat$survival, dnn = c(&quot;TX&quot;, &quot;Survival&quot;))
X
d &lt;- factor(c(&quot;treat&quot;,&quot;notreat&quot;), levels=c(&quot;treat&quot;,&quot;notreat&quot;))
modci &lt;- glm(X~d, family=binomial)
summary(modci)
exp(confint(modci)[2,]) # Conf int
</code></pre>

<p>Residuals </p>
<pre><code class="R">plot(mod) # Pearson Residuals diagnostics
resid(mod, type=&quot;Deviance&quot;) # Deviance, Pearson, Working, Response, Partial
mod$residuals # Gives Working residuals
</code></pre>

<h3 id="contrast-coding">Contrast Coding</h3>
<ul>
<li><a href="https://stats.idre.ucla.edu/r/library/r-library-contrast-coding-systems-for-categorical-variables/#DEVIATION">Overview by UCLA</a></li>
<li>
<p><a href="https://rstudio-pubs-static.s3.amazonaws.com/65059_586f394d8eb84f84b1baaf56ffb6b47f.html">Some more detailed investigation</a></p>
</li>
<li>
<p>Crawley, 2002, is supposed to be a "transparent introduction" to contrast coding, according to <code>adonis</code> documentation</p>
</li>
</ul>
<h2 id="useful-links">Useful Links</h2>
<ul>
<li><a href="https://style.tidyverse.org/">R Style Guide</a></li>
<li><a href="https://www.burns-stat.com/pages/Tutor/R_inferno.pdf">R Inferno</a></li>
<li><a href="http://dwoll.de/rexrepos/index.html">Collection of R Examples</a></li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.ac79c3b0.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>